<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>supervisor_programs - HADeploy</title>
        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../../css/highlight.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
	
	<script src="../../../js/jquery-1.10.2.min.js"></script>
        <script src="../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../js/highlight.pack.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../../..">HADeploy</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="../../..">Home</a>
                    </li>
                    <li >
                        <a href="../../../installation/">Installation</a>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Getting started <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../../getting_started/first_step/">First step</a>
</li>
                            
<li >
    <a href="../../../getting_started/next_step/">Next step</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Plugins reference <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
  <li class="dropdown-submenu">
    <a href="#">Core</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../core/encrypted_vars/">encrypted_vars</a>
</li>
            
<li >
    <a href="../../core/excluded_scopes/">excluded_scopes</a>
</li>
            
<li >
    <a href="../../core/include/">include</a>
</li>
            
<li >
    <a href="../../core/included_scopes/">included_scopes</a>
</li>
            
<li >
    <a href="../../core/vars/">vars</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Ansible</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../ansible/ansible_overview/">Overview</a>
</li>
            
<li >
    <a href="../../ansible/ansible_playbooks/">ansible_playbooks</a>
</li>
            
<li >
    <a href="../../ansible/playbooks_folders/">playbooks_folders</a>
</li>
            
<li >
    <a href="../../ansible/roles_folders/">roles_folders</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Ansible_inventories</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../ansible_inventories/ansible_inventories/">ansible_inventories</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Elasticsearch</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../elastic/elasticsearch_indices/">elasticsearch_indices</a>
</li>
            
<li >
    <a href="../../elastic/elasticsearch_servers/">elasticsearch_servers</a>
</li>
            
<li >
    <a href="../../elastic/elasticsearch_templates/">elasticsearch_templates</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Files</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../files/files/">files</a>
</li>
            
<li >
    <a href="../../files/folders/">folders</a>
</li>
            
<li >
    <a href="../../files/maven_repositories/">maven_repositories</a>
</li>
            
<li >
    <a href="../../files/local_files_folders/">local_files_folders</a>
</li>
            
<li >
    <a href="../../files/local_templates_folders/">local_templates_folders</a>
</li>
            
<li >
    <a href="../../files/trees/">trees</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">HBase</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../hbase/hbase_datasets/">hbase_datasets</a>
</li>
            
<li >
    <a href="../../hbase/hbase_namespaces/">hbase_namespaces</a>
</li>
            
<li >
    <a href="../../hbase/hbase_relay/">hbase_relay</a>
</li>
            
<li >
    <a href="../../hbase/hbase_tables/">hbase_tables</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Hdfs</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../hdfs/hdfs_relay/">hdfs_relay</a>
</li>
            
<li >
    <a href="../../hdfs/source_host_credentials/">source_host_credentials</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Hive</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../hive/hive_databases/">hive_databases</a>
</li>
            
<li >
    <a href="../../hive/hive_relay/">hive_relay</a>
</li>
            
<li >
    <a href="../../hive/hive_tables/">hive_tables</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Inventory</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../inventory/exit_on_fail/">exit_on_fail</a>
</li>
            
<li >
    <a href="../../inventory/hosts/">hosts</a>
</li>
            
<li >
    <a href="../../inventory/host_groups/">host_groups</a>
</li>
            
<li >
    <a href="../../inventory/host_group_overrides/">host_group_overrides</a>
</li>
            
<li >
    <a href="../../inventory/host_overrides/">host_overrides</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Kafka</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../kafka/kafka_relay/">kafka_relay</a>
</li>
            
<li >
    <a href="../../kafka/kafka_topics/">kafka_topic</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Ranger</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../ranger/hbase_ranger_policies/">hbase_ranger_policies</a>
</li>
            
<li >
    <a href="../../ranger/hdfs_ranger_policies/">hdfs_ranger_policies</a>
</li>
            
<li >
    <a href="../../ranger/hive_ranger_policies/">hive_ranger_policies</a>
</li>
            
<li >
    <a href="../../ranger/kafka_ranger_policies/">kafka_ranger_policies</a>
</li>
            
<li >
    <a href="../../ranger/ranger_relay/">ranger_relay</a>
</li>
            
<li >
    <a href="../../ranger/storm_ranger_policies/">storm_ranger_policies</a>
</li>
            
<li >
    <a href="../../ranger/yarn_ranger_policies/">yarn_ranger_policies</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Storm</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../storm/storm_overview/">storm_overview</a>
</li>
            
<li >
    <a href="../../storm/storm_relay/">storm_relay</a>
</li>
            
<li >
    <a href="../../storm/storm_topologies/">storm_topologies</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Systemd</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../systemd/systemd_units/">systemd_units</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Supervisors</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../supervisor_overview/">Overview</a>
</li>
            
<li >
    <a href="../supervisors/">supervisors</a>
</li>
            
<li >
    <a href="../supervisor_groups/">supervisor_groups</a>
</li>
            
<li class="active">
    <a href="./">supervisor_programs</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Users</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../users/groups/">groups</a>
</li>
            
<li >
    <a href="../../users/users/">users</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Yarn</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../yarn/yarn_overview/">yarn_overview</a>
</li>
            
<li >
    <a href="../../yarn/yarn_relay/">yarn_relay</a>
</li>
            
<li >
    <a href="../../yarn/yarn_services/">yarn_service</a>
</li>
    </ul>
  </li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">More <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../../more/conditional_deployment/">Conditional deployment</a>
</li>
                            
<li >
    <a href="../../../more/under_the_hood/">Under the hood</a>
</li>
                            
<li >
    <a href="../../../more/execution_order/">Execution order</a>
</li>
                            
<li >
    <a href="../../../more/altering_scope/">Altering scope</a>
</li>
                            
<li >
    <a href="../../../more/secured_cluster/">Secured cluster</a>
</li>
                            
<li >
    <a href="../../../more/yaml_tricks/">YAML tricks</a>
</li>
                            
<li >
    <a href="../../../more/release_notes/">Release notes</a>
</li>
                        </ul>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../supervisor_groups/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../../users/groups/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#supervisor_programs">supervisor_programs</a></li>
            <li><a href="#synopsis">Synopsis</a></li>
            <li><a href="#attributes">Attributes</a></li>
            <li><a href="#example">Example</a></li>
            <li><a href="#about-managed-programs">About managed programs</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="supervisor_programs">supervisor_programs</h1>
<h2 id="synopsis">Synopsis</h2>
<p>Provide a list of program managed by one (or several) <a href="../supervisors">supervisors</a> instances.</p>
<p>This is a reference part. Refer to the associated <a href="../supervisor_overview"><code>overview</code></a> for a more synthetical view.</p>
<h2 id="attributes">Attributes</h2>
<p>Each item of the list has the following attributes:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>req?</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>supervisor</td>
<td>yes</td>
<td>The supervisor managing this program</td>
</tr>
<tr>
<td>name</td>
<td>yes</td>
<td>Name of the program.</td>
</tr>
<tr>
<td>scope</td>
<td>no</td>
<td>On which target does this supervisor's program be deployed? May be:<ul><li>A single <code>host</code> name</li><li>A single <code>host_group</code> name</li><li>Several <code>hosts</code> or <code>host_groups</code>, separated by the character ':'</li></ul>Default to the supervisor's scope</td>
</tr>
<tr>
<td>command</td>
<td>yes if <code>conf_file_src</code> is not provided</td>
<td>The command to launch. Refer to the <a href="http://supervisord.org/configuration.html#program-x-section-values">supervisor documentation</a></td>
</tr>
<tr>
<td>no_remove</td>
<td>no</td>
<td>Boolean: Prevent this program to be removed when HADeploy will be used with <code>--action remove</code>.<br>Default: <code>no</code></td>
</tr>
<tr>
<td>user</td>
<td>no</td>
<td>From the <a href="http://supervisord.org/configuration.html#program-x-section-values">supervisor documentation</a>: Instruct supervisord to use this UNIX user account as the account which runs the program. The user can only be switched if supervisord is run as the root user. If supervisord can’t switch to the specified user, the program will not be started.<br>Default is the supervisord's user.</td>
</tr>
<tr>
<td>state</td>
<td>no</td>
<td><lu><li><code>started</code>: The program will be started on deployment</li><li><code>stopped</code>: The program will be stopped on deployment.</li><li><code>current</code>: The program state will be left unchanged during deployment. (stopped on initial creation).</li></ul>Default value: <code>started</code>.</td>
</tr>
<tr>
<td>autostart</td>
<td>no</td>
<td>Boolean. If true, this program will start automatically when supervisord is started. Refer to the <a href="http://supervisord.org/configuration.html#program-x-section-values">supervisor documentation</a></td>
</tr>
<tr>
<td>process_name</td>
<td>no</td>
<td>Refer to the <a href="http://supervisord.org/configuration.html#program-x-section-values">supervisor documentation</a></td>
</tr>
<tr>
<td>numprocs</td>
<td>no</td>
<td>Integer. Refer to the <a href="http://supervisord.org/configuration.html#program-x-section-values">supervisor documentation</a></td>
</tr>
<tr>
<td>numprocs_start</td>
<td>no</td>
<td>Integer. Refer to the <a href="http://supervisord.org/configuration.html#program-x-section-values">supervisor documentation</a></td>
</tr>
<tr>
<td>priority</td>
<td>no</td>
<td>Integer. Refer to the <a href="http://supervisord.org/configuration.html#program-x-section-values">supervisor documentation</a></td>
</tr>
<tr>
<td>startsecs</td>
<td>no</td>
<td>Integer. Refer to the <a href="http://supervisord.org/configuration.html#program-x-section-values">supervisor documentation</a></td>
</tr>
<tr>
<td>startretries</td>
<td>no</td>
<td>Integer. Refer to the <a href="http://supervisord.org/configuration.html#program-x-section-values">supervisor documentation</a></td>
</tr>
<tr>
<td>autorestart</td>
<td>no</td>
<td>Refer to the <a href="http://supervisord.org/configuration.html#program-x-section-values">supervisor documentation</a></td>
</tr>
<tr>
<td>exitcodes</td>
<td>no</td>
<td>List of Integer. Refer to the <a href="http://supervisord.org/configuration.html#program-x-section-values">supervisor documentation</a></td>
</tr>
<tr>
<td>stopsignal</td>
<td>no</td>
<td>Refer to the <a href="http://supervisord.org/configuration.html#program-x-section-values">supervisor documentation</a></td>
</tr>
<tr>
<td>stopwaitsecs</td>
<td>no</td>
<td>Integer. Refer to the <a href="http://supervisord.org/configuration.html#program-x-section-values">supervisor documentation</a></td>
</tr>
<tr>
<td>stopasgroup</td>
<td>no</td>
<td>Boolean. Refer to the <a href="http://supervisord.org/configuration.html#program-x-section-values">supervisor documentation</a>. May be required if your program fork another one.</td>
</tr>
<tr>
<td>killasgroup</td>
<td>no</td>
<td>Boolean. Refer to the <a href="http://supervisord.org/configuration.html#program-x-section-values">supervisor documentation</a></td>
</tr>
<tr>
<td>redirect_stderr</td>
<td>no</td>
<td>Boolan. Refer to the <a href="http://supervisord.org/configuration.html#program-x-section-values">supervisor documentation</a></td>
</tr>
<tr>
<td>stdout_logfile</td>
<td>no</td>
<td>Refer to the <a href="http://supervisord.org/configuration.html#program-x-section-values">supervisor documentation</a></td>
</tr>
<tr>
<td>stdout_logfile_maxbytes</td>
<td>no</td>
<td>Refer to the <a href="http://supervisord.org/configuration.html#program-x-section-values">supervisor documentation</a></td>
</tr>
<tr>
<td>stdout_logfile_backups</td>
<td>no</td>
<td>Integer. Refer to the <a href="http://supervisord.org/configuration.html#program-x-section-values">supervisor documentation</a></td>
</tr>
<tr>
<td>stderr_logfile</td>
<td>no</td>
<td>Refer to the <a href="http://supervisord.org/configuration.html#program-x-section-values">supervisor documentation</a></td>
</tr>
<tr>
<td>stderr_logfile_maxbytes</td>
<td>no</td>
<td>Refer to the <a href="http://supervisord.org/configuration.html#program-x-section-values">supervisor documentation</a></td>
</tr>
<tr>
<td>stderr_logfile_backups</td>
<td>no</td>
<td>Integer. Refer to the <a href="http://supervisord.org/configuration.html#program-x-section-values">supervisor documentation</a></td>
</tr>
<tr>
<td>environment</td>
<td>no</td>
<td>List of String. Refer to the <a href="http://supervisord.org/configuration.html#program-x-section-values">supervisor documentation</a></td>
</tr>
<tr>
<td>directory</td>
<td>no</td>
<td>Refer to the <a href="http://supervisord.org/configuration.html#program-x-section-values">supervisor documentation</a></td>
</tr>
<tr>
<td>umask</td>
<td>no</td>
<td>Refer to the <a href="http://supervisord.org/configuration.html#program-x-section-values">supervisor documentation</a></td>
</tr>
<tr>
<td>when</td>
<td>no</td>
<td>Boolean. Allow <a href="../../../more/conditional_deployment">conditional deployment</a> of this item.<br>Default <code>True</code></td>
</tr>
</tbody>
</table>
<h2 id="example">Example</h2>
<pre><code class="yaml">supervisor_programs:
- name: program1
  supervisor: tech1
  command: &quot;/bin/bash /opt/tsupervisor/program1.sh&quot;
</code></pre>

<p>This snippet create a program 'program1' running as a daemon. This program being a simple shell script (<code>program1.sh</code>) and will be managed by the <a href="../supervisors/#example"><code>supervisor named tech1</code></a>.</p>
<p>This program can then be managed (stopped/restarted/...) by:</p>
<ul>
<li>
<p>The Web interface provided by the supervisor, if any.</p>
</li>
<li>
<p>The command line interface <code>supervisorctl_tech1</code></p>
</li>
<li>
<p>HADeploy using <code>--action start</code> and <code>--action stop</code>.</p>
</li>
</ul>
<p>Another example, with more parameters:</p>
<pre><code class="yaml">supervisor_programs:
- name: program2
  supervisor: tech1
  command: &quot;/bin/bash /opt/tsupervisor/program2.sh&quot;
  stopasgroup: yes
  environment:
  - MY_HOME=&quot;/opt/program2&quot;
  - JAVA_HOME=&quot;/usr/java/jdk1.8.0_74&quot;
  directory: /opt/program2/work
  stdout_logfile: /opt/program2/logs/program2.out
  stderr_logfile: /opt/program2/logs/program2.err
</code></pre>

<h2 id="about-managed-programs">About managed programs</h2>
<ul>
<li>
<p><strong>Programs meant to be run under supervisor should not daemonize themselves</strong>. Instead, they should run in the foreground. They should not detach from the terminal from which they are started.
More info <a href="http://supervisord.org/subprocess.html#nondaemonizing-of-subprocesses">here</a></p>
</li>
<li>
<p>If the launched programs fork one or several child processes, there may be a problem on stop. Only the initial process will be killed by supervisor, and all children will become orphan. 
There will be two solutions for this:</p>
<ul>
<li>
<p>Catch the <code>stopsignal</code> and then kill all child processes.</p>
</li>
<li>
<p>Set the <code>stopasgroup</code> flag</p>
</li>
</ul>
<p>This last solution is of course the simplest. </p>
<p>A typical case encountering this issue is a java programs launched by a wrapper script.</p>
</li>
</ul></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '../../..';</script>
        <script data-main="../../../mkdocs/js/search.js" src="../../../mkdocs/js/require.js"></script>
        <script src="../../../js/base.js"></script><div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
